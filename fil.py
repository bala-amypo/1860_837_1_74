import os

# Dictionary containing file paths and their contents
FILES = {
    "pom.xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n\t<modelVersion>4.0.0</modelVersion>\n\t<parent>\n\t\t<groupId>org.springframework.boot</groupId>\n\t\t<artifactId>spring-boot-starter-parent</artifactId>\n\t\t<version>3.2.1</version>\n\t\t<relativePath/> <!-- lookup parent from repository -->\n\t</parent>\n\t<groupId>com.example</groupId>\n\t<artifactId>demo</artifactId>\n\t<version>0.0.1-SNAPSHOT</version>\n\t<name>demo</name>\n\t<description>Insurance Fraud Pattern Detector</description>\n\t<url/>\n\t<licenses>\n\t\t<license/>\n\t</licenses>\n\t<developers>\n\t\t<developer/>\n\t</developers>\n\t<scm>\n\t\t<connection/>\n\t\t<developerConnection/>\n\t\t<tag/>\n\t\t<url/>\n\t</scm>\n\t<properties>\n\t\t<java.version>17</java.version>\n\t</properties>\n\t<dependencies>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-data-jpa</artifactId>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-security</artifactId>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-web</artifactId>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-validation</artifactId>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.mysql</groupId>\n\t\t\t<artifactId>mysql-connector-j</artifactId>\n\t\t\t<scope>runtime</scope>\n\t\t</dependency>\n\t\t\n\t\t<!-- JWT -->\n\t\t<dependency>\n\t\t\t<groupId>io.jsonwebtoken</groupId>\n\t\t\t<artifactId>jjwt-api</artifactId>\n\t\t\t<version>0.11.5</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>io.jsonwebtoken</groupId>\n\t\t\t<artifactId>jjwt-impl</artifactId>\n\t\t\t<version>0.11.5</version>\n\t\t\t<scope>runtime</scope>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>io.jsonwebtoken</groupId>\n\t\t\t<artifactId>jjwt-jackson</artifactId>\n\t\t\t<version>0.11.5</version>\n\t\t\t<scope>runtime</scope>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-tomcat</artifactId>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t<artifactId>spring-boot-starter-test</artifactId>\n\t\t\t<scope>test</scope>\n\t\t\t<exclusions>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.junit.jupiter</groupId>\n\t\t\t\t\t<artifactId>junit-jupiter</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.junit.vintage</groupId>\n\t\t\t\t\t<artifactId>junit-vintage-engine</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.mockito</groupId>\n\t\t\t\t\t<artifactId>mockito-junit-jupiter</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t</exclusions>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springframework.security</groupId>\n\t\t\t<artifactId>spring-security-test</artifactId>\n\t\t\t<scope>test</scope>\n\t\t</dependency>\n\t\t<!-- TestNG Dependency -->\n\t\t<dependency>\n\t\t\t<groupId>org.testng</groupId>\n\t\t\t<artifactId>testng</artifactId>\n\t\t\t<version>7.7.0</version>\n\t\t\t<scope>test</scope>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.springdoc</groupId>\n\t\t\t<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>\n\t\t\t<version>2.3.0</version>\n\t\t</dependency>\n\t</dependencies>\n\n\t<build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.springframework.boot</groupId>\n\t\t\t\t<artifactId>spring-boot-maven-plugin</artifactId>\n\t\t\t</plugin>\n\t\t\t<!-- Configure Maven Surefire Plugin to use TestNG -->\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.apache.maven.plugins</groupId>\n\t\t\t\t<artifactId>maven-surefire-plugin</artifactId>\n\t\t\t\t<version>3.1.2</version>\n\t\t\t\t<configuration>\n\t\t\t\t\t<argLine>-Dnet.bytebuddy.experimental=true</argLine>\n\t\t\t\t</configuration>\n\t\t\t\t<dependencies>\n\t\t\t\t\t<dependency>\n\t\t\t\t\t\t<groupId>org.apache.maven.surefire</groupId>\n\t\t\t\t\t\t<artifactId>surefire-testng</artifactId>\n\t\t\t\t\t\t<version>3.1.2</version>\n\t\t\t\t\t</dependency>\n\t\t\t\t</dependencies>\n\t\t\t</plugin>\n\t\t</plugins>\n\t</build>\n\n</project>",
    "src/main/java/com/example/demo/DemoApplication.java": "package com.example.demo;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.web.servlet.ServletComponentScan;\n\n@SpringBootApplication\n@ServletComponentScan // For the Servlet\npublic class DemoApplication {\n\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(DemoApplication.class, args);\n\t}\n\n}\n",
    "src/main/java/com/example/demo/config/SecurityConfig.java": "package com.example.demo.config;\n\nimport com.example.demo.security.JwtAuthenticationFilter;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.web.SecurityFilterChain;\nimport org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;\n\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n\n    private final JwtAuthenticationFilter jwtAuthenticationFilter;\n\n    public SecurityConfig(JwtAuthenticationFilter jwtAuthenticationFilter) {\n        this.jwtAuthenticationFilter = jwtAuthenticationFilter;\n    }\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http\n            .csrf(AbstractHttpConfigurer::disable)\n            .authorizeHttpRequests(auth -> auth\n                .requestMatchers(\"/auth/register\", \"/auth/login\").permitAll()\n                .requestMatchers(\"/swagger-ui/**\", \"/v3/api-docs/**\").permitAll()\n                .requestMatchers(\"/status\").permitAll() // SimpleStatusServlet\n                .requestMatchers(\"/hello-servlet\").permitAll()\n                .anyRequest().authenticated()\n            )\n            .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n            .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);\n\n        return http.build();\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {\n        return config.getAuthenticationManager();\n    }\n}\n",
    "src/main/java/com/example/demo/config/SwaggerConfig.java": "package com.example.demo.config;\n\nimport io.swagger.v3.oas.models.Components;\nimport io.swagger.v3.oas.models.OpenAPI;\nimport io.swagger.v3.oas.models.security.SecurityRequirement;\nimport io.swagger.v3.oas.models.security.SecurityScheme;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class SwaggerConfig {\n\n    @Bean\n    public OpenAPI customOpenAPI() {\n        return new OpenAPI()\n                .addSecurityItem(new SecurityRequirement().addList(\"Bearer Auth\"))\n                .components(new Components().addSecuritySchemes(\"Bearer Auth\",\n                        new SecurityScheme()\n                                .name(\"Bearer Auth\")\n                                .type(SecurityScheme.Type.HTTP)\n                                .scheme(\"bearer\")\n                                .bearerFormat(\"JWT\")));\n    }\n}\n",
    "src/main/java/com/example/demo/controller/AuthController.java": "package com.example.demo.controller;\n\nimport com.example.demo.dto.AuthRequest;\nimport com.example.demo.dto.AuthResponse;\nimport com.example.demo.model.User;\nimport com.example.demo.security.JwtUtil;\nimport com.example.demo.service.UserService;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"/auth\")\npublic class AuthController {\n\n    private final UserService userService;\n    private final PasswordEncoder passwordEncoder;\n    private final JwtUtil jwtUtil;\n\n    public AuthController(UserService userService, PasswordEncoder passwordEncoder, JwtUtil jwtUtil) {\n        this.userService = userService;\n        this.passwordEncoder = passwordEncoder;\n        this.jwtUtil = jwtUtil;\n    }\n\n    @PostMapping(\"/register\")\n    public ResponseEntity<?> register(@RequestBody AuthRequest request) {\n        User user = new User(request.getName(), request.getEmail(), request.getPassword(), \"USER\");\n        User saved = userService.register(user);\n        return ResponseEntity.ok(saved);\n    }\n\n    @PostMapping(\"/login\")\n    public ResponseEntity<?> login(@RequestBody AuthRequest request) {\n        User user = userService.findByEmail(request.getEmail());\n        if (passwordEncoder.matches(request.getPassword(), user.getPassword())) {\n            String token = jwtUtil.generateToken(user);\n            return ResponseEntity.ok(new AuthResponse(token, user.getId(), user.getEmail(), user.getRole()));\n        }\n        return ResponseEntity.status(401).body(\"Invalid credentials\");\n    }\n}\n",
    "src/main/java/com/example/demo/controller/ClaimController.java": "package com.example.demo.controller;\n\nimport com.example.demo.dto.ClaimDto;\nimport com.example.demo.model.Claim;\nimport com.example.demo.service.ClaimService;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n@RestController\n@RequestMapping(\"/api/claims\")\npublic class ClaimController {\n\n    private final ClaimService claimService;\n\n    public ClaimController(ClaimService claimService) {\n        this.claimService = claimService;\n    }\n\n    @PostMapping(\"/{policyId}\")\n    public ResponseEntity<ClaimDto> createClaim(@PathVariable Long policyId, @RequestBody ClaimDto dto) {\n        Claim claim = new Claim();\n        claim.setClaimDate(dto.getClaimDate());\n        claim.setClaimAmount(dto.getClaimAmount());\n        claim.setDescription(dto.getDescription());\n        // status is set in service to PENDING if null\n\n        Claim saved = claimService.createClaim(policyId, claim);\n        return ResponseEntity.ok(mapToDto(saved));\n    }\n\n    @GetMapping(\"/{id}\")\n    public ResponseEntity<ClaimDto> getClaim(@PathVariable Long id) {\n        Claim claim = claimService.getClaim(id);\n        return ResponseEntity.ok(mapToDto(claim));\n    }\n\n    @GetMapping\n    public ResponseEntity<List<ClaimDto>> getAllClaims() {\n        List<Claim> claims = claimService.getAllClaims();\n        return ResponseEntity.ok(claims.stream().map(this::mapToDto).collect(Collectors.toList()));\n    }\n\n    private ClaimDto mapToDto(Claim claim) {\n        ClaimDto dto = new ClaimDto();\n        dto.setId(claim.getId());\n        dto.setPolicyId(claim.getPolicy().getId());\n        dto.setClaimDate(claim.getClaimDate());\n        dto.setClaimAmount(claim.getClaimAmount());\n        dto.setDescription(claim.getDescription());\n        dto.setStatus(claim.getStatus());\n        return dto;\n    }\n}\n",
    "src/main/java/com/example/demo/controller/FraudDetectionController.java": "package com.example.demo.controller;\n\nimport com.example.demo.dto.FraudCheckResultDto;\nimport com.example.demo.model.FraudCheckResult;\nimport com.example.demo.service.FraudDetectionService;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\n\n@RestController\n@RequestMapping(\"/api/fraud-check\")\npublic class FraudDetectionController {\n\n    private final FraudDetectionService fraudDetectionService;\n\n    public FraudDetectionController(FraudDetectionService fraudDetectionService) {\n        this.fraudDetectionService = fraudDetectionService;\n    }\n\n    @PostMapping(\"/evaluate/{claimId}\")\n    public ResponseEntity<FraudCheckResultDto> evaluateClaim(@PathVariable Long claimId) {\n        FraudCheckResult result = fraudDetectionService.evaluateClaim(claimId);\n        return ResponseEntity.ok(mapToDto(result));\n    }\n\n    @GetMapping(\"/result/claim/{claimId}\")\n    public ResponseEntity<FraudCheckResultDto> getResultByClaim(@PathVariable Long claimId) {\n        FraudCheckResult result = fraudDetectionService.getResultByClaim(claimId);\n        return ResponseEntity.ok(mapToDto(result));\n    }\n\n    private FraudCheckResultDto mapToDto(FraudCheckResult result) {\n        FraudCheckResultDto dto = new FraudCheckResultDto();\n        dto.setClaimId(result.getClaim().getId());\n        dto.setIsFraudulent(result.getIsFraudulent());\n        dto.setTriggeredRuleName(result.getTriggeredRuleName());\n        dto.setRejectionReason(result.getRejectionReason());\n        dto.setCheckedAt(result.getCheckedAt());\n        return dto;\n    }\n}\n",
    "src/main/java/com/example/demo/controller/FraudRuleController.java": "package com.example.demo.controller;\n\nimport com.example.demo.dto.FraudRuleDto;\nimport com.example.demo.model.FraudRule;\nimport com.example.demo.service.FraudRuleService;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n@RestController\n@RequestMapping(\"/api/rules\")\npublic class FraudRuleController {\n\n    private final FraudRuleService fraudRuleService;\n\n    public FraudRuleController(FraudRuleService fraudRuleService) {\n        this.fraudRuleService = fraudRuleService;\n    }\n\n    @PostMapping\n    public ResponseEntity<FraudRuleDto> addRule(@RequestBody FraudRuleDto dto) {\n        FraudRule rule = new FraudRule(dto.getRuleName(), dto.getConditionField(), dto.getOperator(), dto.getValue(), dto.getSeverity());\n        FraudRule saved = fraudRuleService.addRule(rule);\n        return ResponseEntity.ok(mapToDto(saved));\n    }\n\n    @GetMapping\n    public ResponseEntity<List<FraudRuleDto>> getAllRules() {\n        List<FraudRule> rules = fraudRuleService.getAllRules();\n        return ResponseEntity.ok(rules.stream().map(this::mapToDto).collect(Collectors.toList()));\n    }\n\n    private FraudRuleDto mapToDto(FraudRule rule) {\n        FraudRuleDto dto = new FraudRuleDto();\n        dto.setId(rule.getId());\n        dto.setRuleName(rule.getRuleName());\n        dto.setConditionField(rule.getConditionField());\n        dto.setOperator(rule.getOperator());\n        dto.setValue(rule.getValue());\n        dto.setSeverity(rule.getSeverity());\n        return dto;\n    }\n}\n",
    "src/main/java/com/example/demo/controller/PolicyController.java": "package com.example.demo.controller;\n\nimport com.example.demo.dto.PolicyDto;\nimport com.example.demo.model.Policy;\nimport com.example.demo.service.PolicyService;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n@RestController\n@RequestMapping(\"/api/policies\")\npublic class PolicyController {\n\n    private final PolicyService policyService;\n\n    public PolicyController(PolicyService policyService) {\n        this.policyService = policyService;\n    }\n\n    @PostMapping(\"/{userId}\")\n    public ResponseEntity<PolicyDto> createPolicy(@PathVariable Long userId, @RequestBody PolicyDto dto) {\n        Policy policy = new Policy();\n        policy.setPolicyNumber(dto.getPolicyNumber());\n        policy.setPolicyType(dto.getPolicyType());\n        policy.setStartDate(dto.getStartDate());\n        policy.setEndDate(dto.getEndDate());\n\n        Policy saved = policyService.createPolicy(userId, policy);\n        return ResponseEntity.ok(mapToDto(saved));\n    }\n\n    @GetMapping(\"/user/{userId}\")\n    public ResponseEntity<List<PolicyDto>> getPoliciesByUser(@PathVariable Long userId) {\n        List<Policy> policies = policyService.getPoliciesByUser(userId);\n        List<PolicyDto> dtos = policies.stream().map(this::mapToDto).collect(Collectors.toList());\n        return ResponseEntity.ok(dtos);\n    }\n\n    private PolicyDto mapToDto(Policy policy) {\n        PolicyDto dto = new PolicyDto();\n        dto.setId(policy.getId());\n        dto.setUserId(policy.getUser().getId());\n        dto.setPolicyNumber(policy.getPolicyNumber());\n        dto.setPolicyType(policy.getPolicyType());\n        dto.setStartDate(policy.getStartDate());\n        dto.setEndDate(policy.getEndDate());\n        return dto;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/ApiResponse.java": "package com.example.demo.dto;\n\nimport java.time.LocalDateTime;\n\npublic class ApiResponse {\n    private LocalDateTime timestamp;\n    private String message;\n    private String details;\n\n    public ApiResponse(LocalDateTime timestamp, String message, String details) {\n        this.timestamp = timestamp;\n        this.message = message;\n        this.details = details;\n    }\n\n    public LocalDateTime getTimestamp() {\n        return timestamp;\n    }\n\n    public void setTimestamp(LocalDateTime timestamp) {\n        this.timestamp = timestamp;\n    }\n\n    public String getMessage() {\n        return message;\n    }\n\n    public void setMessage(String message) {\n        this.message = message;\n    }\n\n    public String getDetails() {\n        return details;\n    }\n\n    public void setDetails(String details) {\n        this.details = details;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/AuthRequest.java": "package com.example.demo.dto;\n\npublic class AuthRequest {\n    private String name;\n    private String email;\n    private String password;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/AuthResponse.java": "package com.example.demo.dto;\n\npublic class AuthResponse {\n    private String token;\n    private Long userId;\n    private String email;\n    private String role;\n\n    public AuthResponse(String token, Long userId, String email, String role) {\n        this.token = token;\n        this.userId = userId;\n        this.email = email;\n        this.role = role;\n    }\n\n    public String getToken() {\n        return token;\n    }\n\n    public void setToken(String token) {\n        this.token = token;\n    }\n\n    public Long getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Long userId) {\n        this.userId = userId;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public String getRole() {\n        return role;\n    }\n\n    public void setRole(String role) {\n        this.role = role;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/ClaimDto.java": "package com.example.demo.dto;\n\nimport java.time.LocalDate;\n\npublic class ClaimDto {\n    private Long id;\n    private Long policyId;\n    private LocalDate claimDate;\n    private Double claimAmount;\n    private String description;\n    private String status;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public Long getPolicyId() {\n        return policyId;\n    }\n\n    public void setPolicyId(Long policyId) {\n        this.policyId = policyId;\n    }\n\n    public LocalDate getClaimDate() {\n        return claimDate;\n    }\n\n    public void setClaimDate(LocalDate claimDate) {\n        this.claimDate = claimDate;\n    }\n\n    public Double getClaimAmount() {\n        return claimAmount;\n    }\n\n    public void setClaimAmount(Double claimAmount) {\n        this.claimAmount = claimAmount;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getStatus() {\n        return status;\n    }\n\n    public void setStatus(String status) {\n        this.status = status;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/FraudCheckResultDto.java": "package com.example.demo.dto;\n\nimport java.time.LocalDateTime;\n\npublic class FraudCheckResultDto {\n    private Long claimId;\n    private Boolean isFraudulent;\n    private String triggeredRuleName;\n    private String rejectionReason;\n    private LocalDateTime checkedAt;\n\n    public Long getClaimId() {\n        return claimId;\n    }\n\n    public void setClaimId(Long claimId) {\n        this.claimId = claimId;\n    }\n\n    public Boolean getIsFraudulent() {\n        return isFraudulent;\n    }\n\n    public void setIsFraudulent(Boolean fraudulent) {\n        isFraudulent = fraudulent;\n    }\n\n    public String getTriggeredRuleName() {\n        return triggeredRuleName;\n    }\n\n    public void setTriggeredRuleName(String triggeredRuleName) {\n        this.triggeredRuleName = triggeredRuleName;\n    }\n\n    public String getRejectionReason() {\n        return rejectionReason;\n    }\n\n    public void setRejectionReason(String rejectionReason) {\n        this.rejectionReason = rejectionReason;\n    }\n\n    public LocalDateTime getCheckedAt() {\n        return checkedAt;\n    }\n\n    public void setCheckedAt(LocalDateTime checkedAt) {\n        this.checkedAt = checkedAt;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/FraudRuleDto.java": "package com.example.demo.dto;\n\npublic class FraudRuleDto {\n    private Long id;\n    private String ruleName;\n    private String conditionField;\n    private String operator;\n    private String value;\n    private String severity;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getRuleName() {\n        return ruleName;\n    }\n\n    public void setRuleName(String ruleName) {\n        this.ruleName = ruleName;\n    }\n\n    public String getConditionField() {\n        return conditionField;\n    }\n\n    public void setConditionField(String conditionField) {\n        this.conditionField = conditionField;\n    }\n\n    public String getOperator() {\n        return operator;\n    }\n\n    public void setOperator(String operator) {\n        this.operator = operator;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n\n    public String getSeverity() {\n        return severity;\n    }\n\n    public void setSeverity(String severity) {\n        this.severity = severity;\n    }\n}\n",
    "src/main/java/com/example/demo/dto/PolicyDto.java": "package com.example.demo.dto;\n\nimport java.time.LocalDate;\n\npublic class PolicyDto {\n    private Long id;\n    private Long userId;\n    private String policyNumber;\n    private String policyType;\n    private LocalDate startDate;\n    private LocalDate endDate;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public Long getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Long userId) {\n        this.userId = userId;\n    }\n\n    public String getPolicyNumber() {\n        return policyNumber;\n    }\n\n    public void setPolicyNumber(String policyNumber) {\n        this.policyNumber = policyNumber;\n    }\n\n    public String getPolicyType() {\n        return policyType;\n    }\n\n    public void setPolicyType(String policyType) {\n        this.policyType = policyType;\n    }\n\n    public LocalDate getStartDate() {\n        return startDate;\n    }\n\n    public void setStartDate(LocalDate startDate) {\n        this.startDate = startDate;\n    }\n\n    public LocalDate getEndDate() {\n        return endDate;\n    }\n\n    public void setEndDate(LocalDate endDate) {\n        this.endDate = endDate;\n    }\n}\n",
    "src/main/java/com/example/demo/exception/GlobalExceptionHandler.java": "package com.example.demo.exception;\n\nimport com.example.demo.dto.ApiResponse;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.ExceptionHandler;\nimport org.springframework.web.bind.annotation.RestControllerAdvice;\n\nimport java.time.LocalDateTime;\n\n@RestControllerAdvice\npublic class GlobalExceptionHandler {\n\n    @ExceptionHandler(ResourceNotFoundException.class)\n    public ResponseEntity<ApiResponse> handleResourceNotFound(ResourceNotFoundException ex) {\n        ApiResponse response = new ApiResponse(LocalDateTime.now(), \"Not Found\", ex.getMessage());\n        return new ResponseEntity<>(response, HttpStatus.NOT_FOUND);\n    }\n\n    @ExceptionHandler(IllegalArgumentException.class)\n    public ResponseEntity<ApiResponse> handleIllegalArgument(IllegalArgumentException ex) {\n        ApiResponse response = new ApiResponse(LocalDateTime.now(), \"Bad Request\", ex.getMessage());\n        return new ResponseEntity<>(response, HttpStatus.BAD_REQUEST);\n    }\n\n    @ExceptionHandler(Exception.class)\n    public ResponseEntity<ApiResponse> handleGlobalException(Exception ex) {\n        ApiResponse response = new ApiResponse(LocalDateTime.now(), \"Internal Server Error\", ex.getMessage());\n        return new ResponseEntity<>(response, HttpStatus.INTERNAL_SERVER_ERROR);\n    }\n}\n",
    "src/main/java/com/example/demo/exception/ResourceNotFoundException.java": "package com.example.demo.exception;\n\npublic class ResourceNotFoundException extends RuntimeException {\n    public ResourceNotFoundException(String message) {\n        super(message);\n    }\n}\n",
    "src/main/java/com/example/demo/model/Claim.java": "package com.example.demo.model;\n\nimport jakarta.persistence.*;\nimport java.time.LocalDate;\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Entity\n@Table(name = \"claims\")\npublic class Claim {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @ManyToOne\n    @JoinColumn(name = \"policy_id\")\n    private Policy policy;\n\n    private LocalDate claimDate;\n    private Double claimAmount;\n    private String description;\n    private String status; // PENDING, APPROVED, REJECTED\n\n    @ManyToMany(cascade = {CascadeType.PERSIST, CascadeType.MERGE})\n    @JoinTable(\n        name = \"claim_suspected_rules\",\n        joinColumns = @JoinColumn(name = \"claim_id\"),\n        inverseJoinColumns = @JoinColumn(name = \"fraud_rule_id\")\n    )\n    private Set<FraudRule> suspectedRules = new HashSet<>();\n\n    @OneToOne(mappedBy = \"claim\", cascade = CascadeType.ALL)\n    private FraudCheckResult fraudCheckResult;\n\n    public Claim() {\n    }\n\n    public Claim(Policy policy, LocalDate claimDate, Double claimAmount, String description) {\n        this.policy = policy;\n        this.claimDate = claimDate;\n        this.claimAmount = claimAmount;\n        this.description = description;\n        this.status = \"PENDING\";\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public Policy getPolicy() {\n        return policy;\n    }\n\n    public void setPolicy(Policy policy) {\n        this.policy = policy;\n    }\n\n    public LocalDate getClaimDate() {\n        return claimDate;\n    }\n\n    public void setClaimDate(LocalDate claimDate) {\n        this.claimDate = claimDate;\n    }\n\n    public Double getClaimAmount() {\n        return claimAmount;\n    }\n\n    public void setClaimAmount(Double claimAmount) {\n        this.claimAmount = claimAmount;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getStatus() {\n        return status;\n    }\n\n    public void setStatus(String status) {\n        this.status = status;\n    }\n\n    public Set<FraudRule> getSuspectedRules() {\n        return suspectedRules;\n    }\n\n    public void setSuspectedRules(Set<FraudRule> suspectedRules) {\n        this.suspectedRules = suspectedRules;\n    }\n\n    public FraudCheckResult getFraudCheckResult() {\n        return fraudCheckResult;\n    }\n\n    public void setFraudCheckResult(FraudCheckResult fraudCheckResult) {\n        this.fraudCheckResult = fraudCheckResult;\n    }\n}\n",
    "src/main/java/com/example/demo/model/FraudCheckResult.java": "package com.example.demo.model;\n\nimport jakarta.persistence.*;\nimport java.time.LocalDateTime;\n\n@Entity\n@Table(name = \"fraud_check_results\")\npublic class FraudCheckResult {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @OneToOne\n    @JoinColumn(name = \"claim_id\")\n    private Claim claim;\n\n    private Boolean isFraudulent;\n    private String triggeredRuleName;\n    private String rejectionReason;\n    private LocalDateTime checkedAt;\n\n    public FraudCheckResult() {\n    }\n\n    public FraudCheckResult(Claim claim, Boolean isFraudulent, String triggeredRuleName, String rejectionReason, LocalDateTime checkedAt) {\n        this.claim = claim;\n        this.isFraudulent = isFraudulent;\n        this.triggeredRuleName = triggeredRuleName;\n        this.rejectionReason = rejectionReason;\n        this.checkedAt = checkedAt;\n    }\n\n    // Getters and Setters\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public Claim getClaim() {\n        return claim;\n    }\n\n    public void setClaim(Claim claim) {\n        this.claim = claim;\n    }\n\n    public Boolean getIsFraudulent() {\n        return isFraudulent;\n    }\n\n    public void setIsFraudulent(Boolean fraudulent) {\n        isFraudulent = fraudulent;\n    }\n\n    public String getTriggeredRuleName() {\n        return triggeredRuleName;\n    }\n\n    public void setTriggeredRuleName(String triggeredRuleName) {\n        this.triggeredRuleName = triggeredRuleName;\n    }\n\n    public String getRejectionReason() {\n        return rejectionReason;\n    }\n\n    public void setRejectionReason(String rejectionReason) {\n        this.rejectionReason = rejectionReason;\n    }\n\n    public LocalDateTime getCheckedAt() {\n        return checkedAt;\n    }\n\n    public void setCheckedAt(LocalDateTime checkedAt) {\n        this.checkedAt = checkedAt;\n    }\n    \n    // Matched rules helper (not in spec but used in test \"testFraudCheckResultSnapshotDoesNotBreak3NF\")\n    // \"FraudCheckResult result = new FraudCheckResult(); result.setMatchedRules(\"Rule1,Rule2\");\"\n    // The test implies there might be a matchedRules field or it's just testing 3NF.\n    // The spec does NOT list `matchedRules` in fields. \n    // Spec fields: id, claim, isFraudulent, triggeredRuleName, rejectionReason, checkedAt.\n    // The test `testFraudCheckResultSnapshotDoesNotBreak3NF` calls `setMatchedRules` and `getMatchedRules`.\n    // This contradicts the spec. I must follow the spec, but if I want the test to pass, I might need to add it or the test is expecting it to be added.\n    // The prompt says \"Fields ... triggeredRuleName ... rejectionReason\".\n    // I will add `matchedRules` field to pass the test, assuming it's an oversight in the spec description vs test.\n    // OR, I can assume `rejectionReason` or `triggeredRuleName` stores it?\n    // No, `triggeredRuleName` is singular.\n    // I'll add `private String matchedRules;` to support the provided test case.\n    \n    private String matchedRules;\n\n    public String getMatchedRules() {\n        return matchedRules;\n    }\n\n    public void setMatchedRules(String matchedRules) {\n        this.matchedRules = matchedRules;\n    }\n}\n",
    "src/main/java/com/example/demo/model/FraudRule.java": "package com.example.demo.model;\n\nimport jakarta.persistence.*;\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Entity\n@Table(name = \"fraud_rules\")\npublic class FraudRule {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(unique = true)\n    private String ruleName;\n\n    private String conditionField;\n    private String operator;\n    private String value;\n    private String severity; // LOW, MEDIUM, HIGH\n\n    @ManyToMany(mappedBy = \"suspectedRules\")\n    private Set<Claim> claims = new HashSet<>();\n\n    public FraudRule() {\n    }\n\n    public FraudRule(String ruleName, String conditionField, String operator, String value, String severity) {\n        this.ruleName = ruleName;\n        this.conditionField = conditionField;\n        this.operator = operator;\n        this.value = value;\n        this.severity = severity;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getRuleName() {\n        return ruleName;\n    }\n\n    public void setRuleName(String ruleName) {\n        this.ruleName = ruleName;\n    }\n\n    public String getConditionField() {\n        return conditionField;\n    }\n\n    public void setConditionField(String conditionField) {\n        this.conditionField = conditionField;\n    }\n\n    public String getOperator() {\n        return operator;\n    }\n\n    public void setOperator(String operator) {\n        this.operator = operator;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n\n    public String getSeverity() {\n        return severity;\n    }\n\n    public void setSeverity(String severity) {\n        this.severity = severity;\n    }\n\n    public Set<Claim> getClaims() {\n        return claims;\n    }\n\n    public void setClaims(Set<Claim> claims) {\n        this.claims = claims;\n    }\n}\n",
    "src/main/java/com/example/demo/model/Policy.java": "package com.example.demo.model;\n\nimport jakarta.persistence.*;\nimport java.time.LocalDate;\nimport java.util.List;\n\n@Entity\n@Table(name = \"policies\")\npublic class Policy {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @ManyToOne\n    @JoinColumn(name = \"user_id\")\n    private User user;\n\n    @Column(unique = true)\n    private String policyNumber;\n\n    private String policyType;\n    private LocalDate startDate;\n    private LocalDate endDate;\n\n    @OneToMany(mappedBy = \"policy\", cascade = CascadeType.ALL)\n    private List<Claim> claims;\n\n    public Policy() {\n    }\n\n    public Policy(User user, String policyNumber, String policyType, LocalDate startDate, LocalDate endDate) {\n        this.user = user;\n        this.policyNumber = policyNumber;\n        this.policyType = policyType;\n        this.startDate = startDate;\n        this.endDate = endDate;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public User getUser() {\n        return user;\n    }\n\n    public void setUser(User user) {\n        this.user = user;\n    }\n\n    public String getPolicyNumber() {\n        return policyNumber;\n    }\n\n    public void setPolicyNumber(String policyNumber) {\n        this.policyNumber = policyNumber;\n    }\n\n    public String getPolicyType() {\n        return policyType;\n    }\n\n    public void setPolicyType(String policyType) {\n        this.policyType = policyType;\n    }\n\n    public LocalDate getStartDate() {\n        return startDate;\n    }\n\n    public void setStartDate(LocalDate startDate) {\n        this.startDate = startDate;\n    }\n\n    public LocalDate getEndDate() {\n        return endDate;\n    }\n\n    public void setEndDate(LocalDate endDate) {\n        this.endDate = endDate;\n    }\n\n    public List<Claim> getClaims() {\n        return claims;\n    }\n\n    public void setClaims(List<Claim> claims) {\n        this.claims = claims;\n    }\n}\n",
    "src/main/java/com/example/demo/model/User.java": "package com.example.demo.model;\n\nimport jakarta.persistence.*;\nimport java.util.List;\n\n@Entity\n@Table(name = \"users\")\npublic class User {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n\n    @Column(unique = true)\n    private String email;\n\n    private String password;\n\n    private String role; // \"USER\" or \"ADMIN\"\n\n    @OneToMany(mappedBy = \"user\", cascade = CascadeType.ALL)\n    private List<Policy> policies;\n\n    public User() {\n    }\n\n    public User(String name, String email, String password, String role) {\n        this.name = name;\n        this.email = email;\n        this.password = password;\n        this.role = role;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getRole() {\n        return role;\n    }\n\n    public void setRole(String role) {\n        this.role = role;\n    }\n\n    public List<Policy> getPolicies() {\n        return policies;\n    }\n\n    public void setPolicies(List<Policy> policies) {\n        this.policies = policies;\n    }\n}\n",
    "src/main/java/com/example/demo/repository/ClaimRepository.java": "package com.example.demo.repository;\n\nimport com.example.demo.model.Claim;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport java.util.List;\n\npublic interface ClaimRepository extends JpaRepository<Claim, Long> {\n    List<Claim> findByPolicyId(Long policyId);\n}\n",
    "src/main/java/com/example/demo/repository/FraudCheckResultRepository.java": "package com.example.demo.repository;\n\nimport com.example.demo.model.FraudCheckResult;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport java.util.Optional;\n\npublic interface FraudCheckResultRepository extends JpaRepository<FraudCheckResult, Long> {\n    Optional<FraudCheckResult> findByClaimId(Long claimId);\n}\n",
    "src/main/java/com/example/demo/repository/FraudRuleRepository.java": "package com.example.demo.repository;\n\nimport com.example.demo.model.FraudRule;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport java.util.Optional;\n\npublic interface FraudRuleRepository extends JpaRepository<FraudRule, Long> {\n    Optional<FraudRule> findByRuleName(String ruleName);\n}\n",
    "src/main/java/com/example/demo/repository/PolicyRepository.java": "package com.example.demo.repository;\n\nimport com.example.demo.model.Policy;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport java.util.List;\nimport java.util.Optional;\n\npublic interface PolicyRepository extends JpaRepository<Policy, Long> {\n    Optional<Policy> findByPolicyNumber(String policyNumber);\n    boolean existsByPolicyNumber(String policyNumber);\n    List<Policy> findByUserId(Long userId);\n}\n",
    "src/main/java/com/example/demo/repository/UserRepository.java": "package com.example.demo.repository;\n\nimport com.example.demo.model.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport java.util.Optional;\n\npublic interface UserRepository extends JpaRepository<User, Long> {\n    Optional<User> findByEmail(String email);\n    boolean existsByEmail(String email);\n}\n",
    "src/main/java/com/example/demo/security/CustomUserDetailsService.java": "package com.example.demo.security;\n\nimport com.example.demo.model.User;\nimport com.example.demo.repository.UserRepository;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.stereotype.Service;\n\nimport java.util.Collections;\n\n@Service\npublic class CustomUserDetailsService implements UserDetailsService {\n\n    private final UserRepository userRepository;\n\n    public CustomUserDetailsService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {\n        User user = userRepository.findByEmail(email)\n                .orElseThrow(() -> new UsernameNotFoundException(\"User not found\"));\n\n        return new org.springframework.security.core.userdetails.User(\n                user.getEmail(),\n                user.getPassword(),\n                Collections.singletonList(new SimpleGrantedAuthority(\"ROLE_\" + user.getRole()))\n        );\n    }\n}\n",
    "src/main/java/com/example/demo/security/JwtAuthenticationFilter.java": "package com.example.demo.security;\n\nimport jakarta.servlet.FilterChain;\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport org.springframework.security.authentication.UsernamePasswordAuthenticationToken;\nimport org.springframework.security.core.context.SecurityContextHolder;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.web.authentication.WebAuthenticationDetailsSource;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.filter.OncePerRequestFilter;\n\nimport java.io.IOException;\n\n@Component\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\n\n    private final JwtUtil jwtUtil;\n    private final CustomUserDetailsService userDetailsService;\n\n    public JwtAuthenticationFilter(JwtUtil jwtUtil, CustomUserDetailsService userDetailsService) {\n        this.jwtUtil = jwtUtil;\n        this.userDetailsService = userDetailsService;\n    }\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)\n            throws ServletException, IOException {\n        \n        final String authHeader = request.getHeader(\"Authorization\");\n        String email = null;\n        String jwt = null;\n\n        if (authHeader != null && authHeader.startsWith(\"Bearer \")) {\n            jwt = authHeader.substring(7);\n            email = jwtUtil.getEmailFromToken(jwt);\n        }\n\n        if (email != null && SecurityContextHolder.getContext().getAuthentication() == null) {\n            UserDetails userDetails = this.userDetailsService.loadUserByUsername(email);\n\n            if (jwtUtil.validateToken(jwt)) {\n                UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(\n                        userDetails, null, userDetails.getAuthorities());\n                authToken.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n                SecurityContextHolder.getContext().setAuthentication(authToken);\n            }\n        }\n        filterChain.doFilter(request, response);\n    }\n}\n",
    "src/main/java/com/example/demo/security/JwtUtil.java": "package com.example.demo.security;\n\nimport com.example.demo.model.User;\nimport io.jsonwebtoken.Claims;\nimport io.jsonwebtoken.Jwts;\nimport io.jsonwebtoken.SignatureAlgorithm;\nimport io.jsonwebtoken.security.Keys;\nimport org.springframework.stereotype.Component;\n\nimport javax.crypto.SecretKey;\nimport java.nio.charset.StandardCharsets;\nimport java.util.Date;\nimport java.util.function.Function;\n\n@Component\npublic class JwtUtil {\n\n    private String secret = \"SuperSecretJwtKeyForDemoProject1234567890\"; // Default\n    private long expirationMillis = 3600000; // Default\n\n    public JwtUtil() {\n    }\n\n    public JwtUtil(String secret, long expirationMillis) {\n        this.secret = secret;\n        this.expirationMillis = expirationMillis;\n    }\n\n    private SecretKey getSigningKey() {\n        return Keys.hmacShaKeyFor(secret.getBytes(StandardCharsets.UTF_8));\n    }\n\n    public String generateToken(User user) {\n        return generateToken(user.getId(), user.getEmail(), user.getRole());\n    }\n\n    public String generateToken(Long userId, String email, String role) {\n        return Jwts.builder()\n                .setSubject(email)\n                .claim(\"userId\", userId)\n                .claim(\"role\", role)\n                .setIssuedAt(new Date())\n                .setExpiration(new Date(System.currentTimeMillis() + expirationMillis))\n                .signWith(getSigningKey(), SignatureAlgorithm.HS256)\n                .compact();\n    }\n\n    public boolean validateToken(String token) {\n        try {\n            Jwts.parserBuilder().setSigningKey(getSigningKey()).build().parseClaimsJws(token);\n            return true;\n        } catch (Exception e) {\n            return false;\n        }\n    }\n\n    public String getEmailFromToken(String token) {\n        return extractClaim(token, Claims::getSubject);\n    }\n\n    public <T> T extractClaim(String token, Function<Claims, T> claimsResolver) {\n        final Claims claims = extractAllClaims(token);\n        return claimsResolver.apply(claims);\n    }\n\n    private Claims extractAllClaims(String token) {\n        return Jwts.parserBuilder().setSigningKey(getSigningKey()).build().parseClaimsJws(token).getBody();\n    }\n}",
    "src/main/java/com/example/demo/service/ClaimService.java": "package com.example.demo.service;\n\nimport com.example.demo.model.Claim;\nimport java.util.List;\n\npublic interface ClaimService {\n    Claim createClaim(Long policyId, Claim claim);\n    Claim getClaim(Long claimId);\n    List<Claim> getAllClaims();\n}\n",
    "src/main/java/com/example/demo/service/FraudDetectionService.java": "package com.example.demo.service;\n\nimport com.example.demo.model.FraudCheckResult;\n\npublic interface FraudDetectionService {\n    FraudCheckResult evaluateClaim(Long claimId);\n    FraudCheckResult getResultByClaim(Long claimId);\n}\n",
    "src/main/java/com/example/demo/service/FraudRuleService.java": "package com.example.demo.service;\n\nimport com.example.demo.model.FraudRule;\nimport java.util.List;\n\npublic interface FraudRuleService {\n    FraudRule addRule(FraudRule rule);\n    List<FraudRule> getAllRules();\n}\n",
    "src/main/java/com/example/demo/service/PolicyService.java": "package com.example.demo.service;\n\nimport com.example.demo.model.Policy;\nimport java.util.List;\n\npublic interface PolicyService {\n    Policy createPolicy(Long userId, Policy policy);\n    List<Policy> getPoliciesByUser(Long userId);\n    Policy getPolicy(Long id);\n}\n",
    "src/main/java/com/example/demo/service/UserService.java": "package com.example.demo.service;\n\nimport com.example.demo.model.User;\n\npublic interface UserService {\n    User register(User user);\n    User findByEmail(String email);\n    User findById(Long id);\n}\n",
    "src/main/java/com/example/demo/service/impl/ClaimServiceImpl.java": "package com.example.demo.service.impl;\n\nimport com.example.demo.exception.ResourceNotFoundException;\nimport com.example.demo.model.Claim;\nimport com.example.demo.model.Policy;\nimport com.example.demo.repository.ClaimRepository;\nimport com.example.demo.repository.PolicyRepository;\nimport com.example.demo.service.ClaimService;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport java.time.LocalDate;\nimport java.util.List;\n\n@Service\n@Transactional\npublic class ClaimServiceImpl implements ClaimService {\n\n    private final ClaimRepository claimRepository;\n    private final PolicyRepository policyRepository;\n\n    public ClaimServiceImpl(ClaimRepository claimRepository, PolicyRepository policyRepository) {\n        this.claimRepository = claimRepository;\n        this.policyRepository = policyRepository;\n    }\n\n    @Override\n    public Claim createClaim(Long policyId, Claim claim) {\n        Policy policy = policyRepository.findById(policyId)\n                .orElseThrow(() -> new ResourceNotFoundException(\"Policy not found\"));\n\n        if (claim.getClaimAmount() < 0) {\n            throw new IllegalArgumentException(\"Invalid claim amount\");\n        }\n        if (claim.getClaimDate().isAfter(LocalDate.now())) {\n            throw new IllegalArgumentException(\"Invalid claim date\");\n        }\n\n        claim.setPolicy(policy);\n        if (claim.getStatus() == null) {\n            claim.setStatus(\"PENDING\");\n        }\n        return claimRepository.save(claim);\n    }\n\n    @Override\n    public Claim getClaim(Long claimId) {\n        return claimRepository.findById(claimId)\n                .orElseThrow(() -> new ResourceNotFoundException(\"Claim not found\"));\n    }\n\n    @Override\n    public List<Claim> getAllClaims() {\n        return claimRepository.findAll();\n    }\n}\n",
    "src/main/java/com/example/demo/service/impl/FraudDetectionServiceImpl.java": "package com.example.demo.service.impl;\n\nimport com.example.demo.exception.ResourceNotFoundException;\nimport com.example.demo.model.Claim;\nimport com.example.demo.model.FraudCheckResult;\nimport com.example.demo.model.FraudRule;\nimport com.example.demo.repository.ClaimRepository;\nimport com.example.demo.repository.FraudCheckResultRepository;\nimport com.example.demo.repository.FraudRuleRepository;\nimport com.example.demo.service.FraudDetectionService;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport java.time.LocalDateTime;\nimport java.util.List;\nimport java.util.stream.Collectors;\n\n@Service\n@Transactional\npublic class FraudDetectionServiceImpl implements FraudDetectionService {\n\n    private final ClaimRepository claimRepository;\n    private final FraudRuleRepository fraudRuleRepository;\n    private final FraudCheckResultRepository resultRepository;\n\n    public FraudDetectionServiceImpl(ClaimRepository claimRepository, FraudRuleRepository fraudRuleRepository, FraudCheckResultRepository resultRepository) {\n        this.claimRepository = claimRepository;\n        this.fraudRuleRepository = fraudRuleRepository;\n        this.resultRepository = resultRepository;\n    }\n\n    @Override\n    public FraudCheckResult evaluateClaim(Long claimId) {\n        Claim claim = claimRepository.findById(claimId)\n                .orElseThrow(() -> new ResourceNotFoundException(\"Claim not found\"));\n\n        List<FraudRule> allRules = fraudRuleRepository.findAll();\n        boolean isFraudulent = false;\n        String triggeredRuleName = null;\n        String rejectionReason = null;\n        StringBuilder matchedRulesStr = new StringBuilder();\n\n        // Clear existing suspected rules if re-evaluating (optional, but good practice)\n        claim.getSuspectedRules().clear();\n\n        for (FraudRule rule : allRules) {\n            boolean match = false;\n            if (\"claimAmount\".equals(rule.getConditionField())) {\n                double threshold = Double.parseDouble(rule.getValue());\n                double amount = claim.getClaimAmount();\n                switch (rule.getOperator()) {\n                    case \">\": match = amount > threshold; break;\n                    case \"<\": match = amount < threshold; break;\n                    case \">=\": match = amount >= threshold; break;\n                    case \"<=\": match = amount <= threshold; break;\n                    case \"=\": match = amount == threshold; break;\n                }\n            }\n\n            if (match) {\n                isFraudulent = true;\n                claim.getSuspectedRules().add(rule);\n                if (triggeredRuleName == null) {\n                    triggeredRuleName = rule.getRuleName();\n                    rejectionReason = \"Rule \" + rule.getRuleName() + \" triggered: \" + rule.getConditionField() + \" \" + rule.getOperator() + \" \" + rule.getValue();\n                }\n                if (matchedRulesStr.length() > 0) matchedRulesStr.append(\",\");\n                matchedRulesStr.append(rule.getRuleName());\n            }\n        }\n\n        FraudCheckResult result = new FraudCheckResult();\n        result.setClaim(claim);\n        result.setIsFraudulent(isFraudulent);\n        result.setTriggeredRuleName(triggeredRuleName);\n        result.setRejectionReason(rejectionReason);\n        result.setCheckedAt(LocalDateTime.now());\n        result.setMatchedRules(matchedRulesStr.toString());\n\n        // claim.setFraudCheckResult(result); // bi-directional\n        // Save claim to update suspectedRules\n        claimRepository.save(claim);\n\n        return resultRepository.save(result);\n    }\n\n    @Override\n    public FraudCheckResult getResultByClaim(Long claimId) {\n        return resultRepository.findByClaimId(claimId)\n                .orElseThrow(() -> new ResourceNotFoundException(\"Result not found\"));\n    }\n}\n",
    "src/main/java/com/example/demo/service/impl/FraudRuleServiceImpl.java": "package com.example.demo.service.impl;\n\nimport com.example.demo.model.FraudRule;\nimport com.example.demo.repository.FraudRuleRepository;\nimport com.example.demo.service.FraudRuleService;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport java.util.List;\nimport java.util.Set;\n\n@Service\n@Transactional\npublic class FraudRuleServiceImpl implements FraudRuleService {\n\n    private final FraudRuleRepository fraudRuleRepository;\n    private static final Set<String> ALLOWED_SEVERITIES = Set.of(\"LOW\", \"MEDIUM\", \"HIGH\");\n\n    public FraudRuleServiceImpl(FraudRuleRepository fraudRuleRepository) {\n        this.fraudRuleRepository = fraudRuleRepository;\n    }\n\n    @Override\n    public FraudRule addRule(FraudRule rule) {\n        if (fraudRuleRepository.findByRuleName(rule.getRuleName()).isPresent()) {\n            throw new IllegalArgumentException(\"Invalid or duplicate rule name\");\n        }\n        if (!ALLOWED_SEVERITIES.contains(rule.getSeverity())) {\n            throw new IllegalArgumentException(\"Invalid severity\");\n        }\n        return fraudRuleRepository.save(rule);\n    }\n\n    @Override\n    public List<FraudRule> getAllRules() {\n        return fraudRuleRepository.findAll();\n    }\n}\n",
    "src/main/java/com/example/demo/service/impl/PolicyServiceImpl.java": "package com.example.demo.service.impl;\n\nimport com.example.demo.exception.ResourceNotFoundException;\nimport com.example.demo.model.Policy;\nimport com.example.demo.model.User;\nimport com.example.demo.repository.PolicyRepository;\nimport com.example.demo.repository.UserRepository;\nimport com.example.demo.service.PolicyService;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport java.util.List;\n\n@Service\n@Transactional\npublic class PolicyServiceImpl implements PolicyService {\n\n    private final PolicyRepository policyRepository;\n    private final UserRepository userRepository;\n\n    public PolicyServiceImpl(PolicyRepository policyRepository, UserRepository userRepository) {\n        this.policyRepository = policyRepository;\n        this.userRepository = userRepository;\n    }\n\n    @Override\n    public Policy createPolicy(Long userId, Policy policy) {\n        User user = userRepository.findById(userId)\n                .orElseThrow(() -> new ResourceNotFoundException(\"User not found\"));\n\n        if (policyRepository.existsByPolicyNumber(policy.getPolicyNumber())) {\n            throw new IllegalArgumentException(\"Policy number already exists\");\n        }\n        if (!policy.getEndDate().isAfter(policy.getStartDate())) {\n            throw new IllegalArgumentException(\"Invalid dates: End date must be after Start date\");\n        }\n\n        policy.setUser(user);\n        return policyRepository.save(policy);\n    }\n\n    @Override\n    public List<Policy> getPoliciesByUser(Long userId) {\n        if (!userRepository.existsById(userId)) {\n            // Per spec \"If associated user is not found... throw ResourceNotFoundException\"\n            // Wait, spec says \"If associated user is not found for given userId, throw ResourceNotFoundException\"\n            // The method logic should check user existence if required, but list usually just returns empty.\n            // However, the spec says \"Load user by userId; if absent, throw ResourceNotFoundException\".\n            // So I should check.\n             if (!userRepository.existsById(userId)) {\n                 // Or actually load it to be sure.\n                 // But the method signature just returns List<Policy>.\n                 // I will strictly follow spec: \"Load user by userId; if absent, throw ResourceNotFoundException\".\n                 // Actually the spec point \"If associated user is not found for given userId...\" was under \"Rules (PolicyService)\".\n                 // So I should implement that check.\n                 throw new ResourceNotFoundException(\"User not found\");\n             }\n        }\n        return policyRepository.findByUserId(userId);\n    }\n\n    @Override\n    public Policy getPolicy(Long id) {\n        return policyRepository.findById(id)\n                .orElseThrow(() -> new ResourceNotFoundException(\"Policy not found\"));\n    }\n}\n",
    "src/main/java/com/example/demo/service/impl/UserServiceImpl.java": "package com.example.demo.service.impl;\n\nimport com.example.demo.exception.ResourceNotFoundException;\nimport com.example.demo.model.User;\nimport com.example.demo.repository.UserRepository;\nimport com.example.demo.service.UserService;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\n@Service\n@Transactional\npublic class UserServiceImpl implements UserService {\n\n    private final UserRepository userRepository;\n    private final PasswordEncoder passwordEncoder;\n\n    public UserServiceImpl(UserRepository userRepository, PasswordEncoder passwordEncoder) {\n        this.userRepository = userRepository;\n        this.passwordEncoder = passwordEncoder;\n    }\n\n    @Override\n    public User register(User user) {\n        if (userRepository.existsByEmail(user.getEmail())) {\n            throw new IllegalArgumentException(\"Email already exists\");\n        }\n        if (user.getRole() == null || user.getRole().isEmpty()) {\n            user.setRole(\"USER\");\n        }\n        user.setPassword(passwordEncoder.encode(user.getPassword()));\n        return userRepository.save(user);\n    }\n\n    @Override\n    public User findByEmail(String email) {\n        return userRepository.findByEmail(email)\n                .orElseThrow(() -> new ResourceNotFoundException(\"User not found\"));\n    }\n\n    @Override\n    public User findById(Long id) {\n        return userRepository.findById(id)\n                .orElseThrow(() -> new ResourceNotFoundException(\"User not found\"));\n    }\n}\n",
    "src/main/java/com/example/demo/servlet/HelloServlet.java": "package com.example.demo.servlet;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.annotation.WebServlet;\nimport jakarta.servlet.http.HttpServlet;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n@WebServlet(urlPatterns = \"/hello-servlet\")\npublic class HelloServlet extends HttpServlet {\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.setContentType(\"text/plain\");\n        resp.getWriter().write(\"Hello from HelloServlet\");\n    }\n}\n",
    "src/main/java/com/example/demo/servlet/SimpleStatusServlet.java": "package com.example.demo.servlet;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.annotation.WebServlet;\nimport jakarta.servlet.http.HttpServlet;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n@WebServlet(urlPatterns = \"/status\")\npublic class SimpleStatusServlet extends HttpServlet {\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        resp.setContentType(\"text/plain\");\n        resp.getWriter().write(\"OK\");\n    }\n}\n",
    "src/main/java/com/example/demo/util/HqlQueryHelper.java": "package com.example.demo.util;\n\nimport com.example.demo.model.Claim;\nimport jakarta.persistence.EntityManager;\nimport jakarta.persistence.PersistenceContext;\nimport jakarta.persistence.TypedQuery;\nimport jakarta.persistence.criteria.CriteriaBuilder;\nimport jakarta.persistence.criteria.CriteriaQuery;\nimport jakarta.persistence.criteria.Root;\nimport org.springframework.stereotype.Component;\n\nimport java.util.List;\n\n@Component\npublic class HqlQueryHelper {\n\n    @PersistenceContext\n    private EntityManager entityManager;\n\n    public List<Claim> findHighValueClaims(double minAmount) {\n        String hql = \"FROM Claim c WHERE c.claimAmount > :minAmount\";\n        TypedQuery<Claim> query = entityManager.createQuery(hql, Claim.class);\n        query.setParameter(\"minAmount\", minAmount);\n        return query.getResultList();\n    }\n\n    public List<Claim> findClaimsByDescriptionKeyword(String keyword) {\n        CriteriaBuilder cb = entityManager.getCriteriaBuilder();\n        CriteriaQuery<Claim> cq = cb.createQuery(Claim.class);\n        Root<Claim> claim = cq.from(Claim.class);\n        \n        if (keyword != null && !keyword.isEmpty()) {\n            cq.where(cb.like(claim.get(\"description\"), \"%\" + keyword + \"%\"));\n        }\n        \n        return entityManager.createQuery(cq).getResultList();\n    }\n}\n",
    "src/main/resources/application.properties": "spring.application.name=demo\n\nspring.datasource.url=jdbc:mysql://localhost:3306/demo_db\nspring.datasource.username=root\nspring.datasource.password=\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n\nspring.jpa.hibernate.ddl-auto=update\nspring.jpa.show-sql=true\nspring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect\n",
    "src/test/java/com/example/demo/DemoApplicationTests.java": "package com.example.demo;\n\nimport com.example.demo.model.*;\nimport com.example.demo.repository.*;\nimport com.example.demo.security.JwtUtil;\nimport com.example.demo.service.*;\nimport com.example.demo.service.impl.*;\nimport com.example.demo.util.HqlQueryHelper;\nimport org.mockito.Mockito;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.testng.Assert;\nimport org.testng.annotations.BeforeClass;\nimport org.testng.annotations.Listeners;\nimport org.testng.annotations.Test;\n\nimport java.time.LocalDate;\nimport java.util.List;\nimport java.util.Optional;\nimport java.util.Set;\n\nimport static org.mockito.ArgumentMatchers.*;\nimport static org.mockito.Mockito.when;\n\n@Listeners(TestResultListener.class)\npublic class DemoApplicationTests {\n\n    private UserRepository userRepository;\n    private PolicyRepository policyRepository;\n    private ClaimRepository claimRepository;\n    private FraudRuleRepository fraudRuleRepository;\n    private FraudCheckResultRepository resultRepository;\n    private HqlQueryHelper hqlQueryHelper;\n\n    private UserService userService;\n    private PolicyService policyService;\n    private ClaimService claimService;\n    private FraudRuleService fraudRuleService;\n    private FraudDetectionService fraudDetectionService;\n\n    private PasswordEncoder passwordEncoder;\n\n    @BeforeClass\n    public void setup() {\n        userRepository = Mockito.mock(UserRepository.class);\n        policyRepository = Mockito.mock(PolicyRepository.class);\n        claimRepository = Mockito.mock(ClaimRepository.class);\n        fraudRuleRepository = Mockito.mock(FraudRuleRepository.class);\n        resultRepository = Mockito.mock(FraudCheckResultRepository.class);\n        hqlQueryHelper = Mockito.mock(HqlQueryHelper.class);\n\n        passwordEncoder = new BCryptPasswordEncoder();\n\n        userService = new UserServiceImpl(userRepository, passwordEncoder);\n        policyService = new PolicyServiceImpl(policyRepository, userRepository);\n        claimService = new ClaimServiceImpl(claimRepository, policyRepository);\n        fraudRuleService = new FraudRuleServiceImpl(fraudRuleRepository);\n        fraudDetectionService = new FraudDetectionServiceImpl(\n                claimRepository,\n                fraudRuleRepository,\n                resultRepository\n        );\n    }\n\n    // ============================================================\n    // 1) Develop and deploy a simple servlet using Tomcat Server\n    // ============================================================\n\n    @Test(groups = \"servlet\", priority = 1)\n    public void testHelloServletReturnsText() throws Exception {\n        String contentType = \"text/plain\";\n        Assert.assertEquals(contentType, \"text/plain\");\n    }\n\n    @Test(groups = \"servlet\", priority = 1)\n    public void testHelloServletPathMapping() {\n        String path = \"/hello-servlet\";\n        Assert.assertTrue(path.startsWith(\"/hello\"));\n    }\n\n    @Test(groups = \"servlet\", priority = 1)\n    public void testServletDeployedInContext() {\n        boolean deployed = true; // simulated check\n        Assert.assertTrue(deployed);\n    }\n\n    @Test(groups = \"servlet\", priority = 2)\n    public void testServletSupportsGet() {\n        String method = \"GET\";\n        Assert.assertEquals(method, \"GET\");\n    }\n\n    @Test(groups = \"servlet\", priority = 2)\n    public void testServletDoesNotSupportDelete() {\n        boolean deleteSupported = false;\n        Assert.assertFalse(deleteSupported);\n    }\n\n    @Test(groups = \"servlet\", priority = 3)\n    public void testServletResponseNotNull() {\n        String response = \"Hello from HelloServlet\";\n        Assert.assertNotNull(response);\n    }\n\n    @Test(groups = \"servlet\", priority = 3)\n    public void testServletResponseContainsHello() {\n        String response = \"Hello from HelloServlet\";\n        Assert.assertTrue(response.contains(\"Hello\"));\n    }\n\n    @Test(groups = \"servlet\", priority = 3)\n    public void testServletConfigurationLoadOnStartup() {\n        int loadOnStartup = 1;\n        Assert.assertTrue(loadOnStartup >= 0);\n    }\n\n    // ============================================================\n    // 2) Implement CRUD operations using Spring Boot and REST APIs\n    // ============================================================\n\n    @Test(groups = \"crud\", priority = 4)\n    public void testUserRegistrationSuccess() {\n        User user = new User(\"John\", \"john @example.com\", \"password\", \"USER\");\n\n        when(userRepository.existsByEmail(user.getEmail())).thenReturn(false);\n        when(userRepository.save(any(User.class))).thenAnswer(inv -> inv.getArgument(0));\n\n        User saved = userService.register(user);\n        Assert.assertEquals(saved.getEmail(), \"john @example.com\");\n        Assert.assertNotEquals(saved.getPassword(), \"password\"); // encoded\n    }\n\n    @Test(groups = \"crud\", priority = 4, expectedExceptions = IllegalArgumentException.class)\n    public void testUserRegistrationDuplicateEmail() {\n        User user = new User(\"John\", \"dup @example.com\", \"pass\", \"USER\");\n        when(userRepository.existsByEmail(user.getEmail())).thenReturn(true);\n        userService.register(user);\n    }\n\n    @Test(groups = \"crud\", priority = 4)\n    public void testCreatePolicySuccess() {\n        User user = new User(\"Anna\", \"anna @example.com\", \"pass\", \"USER\");\n        user.setId(1L);\n\n        Policy policy = new Policy(user, \"POL123\", \"HEALTH\",\n                LocalDate.now(), LocalDate.now().plusDays(1));\n\n        when(userRepository.findById(1L)).thenReturn(Optional.of(user));\n        when(policyRepository.existsByPolicyNumber(\"POL123\")).thenReturn(false);\n        when(policyRepository.save(any(Policy.class))).thenAnswer(inv -> inv.getArgument(0));\n\n        Policy saved = policyService.createPolicy(1L, policy);\n        Assert.assertEquals(saved.getPolicyNumber(), \"POL123\");\n    }\n\n    @Test(groups = \"crud\", priority = 4, expectedExceptions = IllegalArgumentException.class)\n    public void testCreatePolicyInvalidDates() {\n        User user = new User(\"Anna\", \"anna @example.com\", \"pass\", \"USER\");\n        user.setId(1L);\n\n        Policy policy = new Policy(user, \"POL999\", \"HEALTH\",\n                LocalDate.now(), LocalDate.now().minusDays(1));\n\n        when(userRepository.findById(1L)).thenReturn(Optional.of(user));\n        policyService.createPolicy(1L, policy);\n    }\n\n    @Test(groups = \"crud\", priority = 4)\n    public void testGetPoliciesByUser() {\n        when(userRepository.existsById(2L)).thenReturn(true);\n        when(policyRepository.findByUserId(2L)).thenReturn(List.of());\n        List<Policy> policies = policyService.getPoliciesByUser(2L);\n        Assert.assertNotNull(policies);\n    }\n\n    @Test(groups = \"crud\", priority = 5)\n    public void testCreateClaimSuccess() {\n        Policy policy = new Policy();\n        policy.setId(1L);\n\n        Claim claim = new Claim(policy, LocalDate.now(), 1000.0, \"Sample claim\");\n\n        when(policyRepository.findById(1L)).thenReturn(Optional.of(policy));\n        when(claimRepository.save(any(Claim.class))).thenAnswer(inv -> inv.getArgument(0));\n\n        Claim saved = claimService.createClaim(1L, claim);\n        Assert.assertEquals(saved.getClaimAmount(), 1000.0);\n    }\n\n    @Test(groups = \"crud\", priority = 5, expectedExceptions = IllegalArgumentException.class)\n    public void testCreateClaimWithFutureDate() {\n        Policy policy = new Policy();\n        policy.setId(1L);\n\n        Claim claim = new Claim(policy, LocalDate.now().plusDays(1), 500.0, \"Future claim\");\n\n        when(policyRepository.findById(1L)).thenReturn(Optional.of(policy));\n        claimService.createClaim(1L, claim);\n    }\n\n    @Test(groups = \"crud\", priority = 5, expectedExceptions = IllegalArgumentException.class)\n    public void testCreateClaimWithNegativeAmount() {\n        Policy policy = new Policy();\n        policy.setId(1L);\n\n        Claim claim = new Claim(policy, LocalDate.now(), -10.0, \"Invalid\");\n\n        when(policyRepository.findById(1L)).thenReturn(Optional.of(policy));\n        claimService.createClaim(1L, claim);\n    }\n\n    // ============================================================\n    // 3) Dependency Injection and IoC using Spring Framework\n    // ============================================================\n\n    @Test(groups = \"di\", priority = 6)\n    public void testUserServiceInjectedWithUserRepository() {\n        Assert.assertNotNull(userService);\n        Assert.assertNotNull(userRepository);\n    }\n\n    @Test(groups = \"di\", priority = 6)\n    public void testPolicyServiceInjectedWithRepositories() {\n        Assert.assertNotNull(policyService);\n        Assert.assertNotNull(policyRepository);\n        Assert.assertNotNull(userRepository);\n    }\n\n    @Test(groups = \"di\", priority = 6)\n    public void testClaimServiceInjectedWithRepositories() {\n        Assert.assertNotNull(claimService);\n        Assert.assertNotNull(claimRepository);\n        Assert.assertNotNull(policyRepository);\n    }\n\n    @Test(groups = \"di\", priority = 7)\n    public void testFraudDetectionServiceInjected() {\n        Assert.assertNotNull(fraudDetectionService);\n        Assert.assertNotNull(fraudRuleRepository);\n    }\n\n    @Test(groups = \"di\", priority = 7)\n    public void testPasswordEncoderIsBCrypt() {\n        Assert.assertTrue(passwordEncoder instanceof BCryptPasswordEncoder);\n    }\n\n    @Test(groups = \"di\", priority = 7)\n    public void testUserServiceRegisterUsesEncoder() {\n        User user = new User(\"Test\", \"enc @example.com\", \"plain\", \"USER\");\n\n        when(userRepository.existsByEmail(user.getEmail())).thenReturn(false);\n        when(userRepository.save(any(User.class))).thenAnswer(inv -> inv.getArgument(0));\n\n        User saved = userService.register(user);\n        Assert.assertNotEquals(saved.getPassword(), \"plain\");\n    }\n\n    @Test(groups = \"di\", priority = 7)\n    public void testIoCHandlesMultipleBeans() {\n        Assert.assertNotNull(fraudRuleService);\n        Assert.assertNotNull(resultRepository);\n    }\n\n    @Test(groups = \"di\", priority = 8)\n    public void testServicesAreTransactionalByDefault() {\n        Assert.assertTrue(true);\n    }\n\n    // ============================================================\n    // 4) Hibernate configurations, generator classes, annotations, CRUD\n    // ============================================================\n\n    @Test(groups = \"hibernate\", priority = 9)\n    public void testUserEntityHasGeneratedId() {\n        User user = new User();\n        user.setId(10L);\n        Assert.assertEquals(user.getId(), Long.valueOf(10L));\n    }\n\n    @Test(groups = \"hibernate\", priority = 9)\n    public void testPolicyEntityUniquePolicyNumberConstraint() {\n        when(policyRepository.existsByPolicyNumber(\"XYZ\")).thenReturn(true);\n        Policy policy = new Policy();\n        policy.setPolicyNumber(\"XYZ\");\n        policy.setStartDate(LocalDate.now());\n        policy.setEndDate(LocalDate.now().plusDays(1));\n        try {\n            policyService.createPolicy(1L, policy);\n            Assert.fail(\"Expected IllegalArgumentException\");\n        } catch (IllegalArgumentException ex) {\n            Assert.assertTrue(ex.getMessage().contains(\"Policy number already exists\"));\n        }\n    }\n\n    @Test(groups = \"hibernate\", priority = 9)\n    public void testFraudRuleEntityValidation() {\n        FraudRule rule = new FraudRule(\"Rule1\", \"claimAmount\", \">\", \"5000\", \"HIGH\");\n        when(fraudRuleRepository.findByRuleName(\"Rule1\")).thenReturn(Optional.empty());\n        when(fraudRuleRepository.save(any(FraudRule.class))).thenAnswer(inv -> inv.getArgument(0));\n        FraudRule saved = fraudRuleService.addRule(rule);\n        Assert.assertEquals(saved.getSeverity(), \"HIGH\");\n    }\n\n    @Test(groups = \"hibernate\", priority = 10, expectedExceptions = IllegalArgumentException.class)\n    public void testFraudRuleInvalidSeverity() {\n        FraudRule rule = new FraudRule(\"Rule2\", \"claimAmount\", \">\", \"5000\", \"CRAZY\");\n        fraudRuleService.addRule(rule);\n    }\n\n    @Test(groups = \"hibernate\", priority = 10)\n    public void testSaveAndRetrieveClaim() {\n        Claim claim = new Claim();\n        claim.setId(5L);\n        when(claimRepository.findById(5L)).thenReturn(Optional.of(claim));\n        Claim found = claimService.getClaim(5L);\n        Assert.assertEquals(found.getId(), Long.valueOf(5L));\n    }\n\n    @Test(groups = \"hibernate\", priority = 10)\n    public void testRepositoryCrudCount() {\n        when(policyRepository.count()).thenReturn(5L);\n        long count = policyRepository.count();\n        Assert.assertEquals(count, 5L);\n    }\n\n    @Test(groups = \"hibernate\", priority = 11)\n    public void testUserEmailUniquenessSimulated() {\n        when(userRepository.existsByEmail(\"unique @example.com\")).thenReturn(false);\n        boolean exists = userRepository.existsByEmail(\"unique @example.com\");\n        Assert.assertFalse(exists);\n    }\n\n    @Test(groups = \"hibernate\", priority = 11)\n    public void testClaimRepositoryFindByPolicyIdReturnsList() {\n        when(claimRepository.findByPolicyId(3L)).thenReturn(List.of());\n        List<Claim> claims = claimRepository.findByPolicyId(3L);\n        Assert.assertNotNull(claims);\n    }\n\n    // ============================================================\n    // 5) JPA mapping with normalization (1NF, 2NF, 3NF)\n    // ============================================================\n\n    @Test(groups = \"jpa\", priority = 12)\n    public void testPolicyIsIn1NF() {\n        Policy policy = new Policy();\n        policy.setPolicyType(\"HEALTH\");\n        Assert.assertEquals(policy.getPolicyType(), \"HEALTH\");\n    }\n\n    @Test(groups = \"jpa\", priority = 12)\n    public void testUserEmailSingleValuedAttribute() {\n        User user = new User();\n        user.setEmail(\"one @example.com\");\n        Assert.assertEquals(user.getEmail(), \"one @example.com\");\n    }\n\n    @Test(groups = \"jpa\", priority = 13)\n    public void testPolicyDependsOnUserId_2NF() {\n        Policy policy = new Policy();\n        User user = new User();\n        user.setId(1L);\n        policy.setUser(user);\n        Assert.assertEquals(policy.getUser().getId(), Long.valueOf(1L));\n    }\n\n    @Test(groups = \"jpa\", priority = 13)\n    public void testClaimDependsOnPolicyId_2NF() {\n        Policy policy = new Policy();\n        policy.setId(2L);\n        Claim claim = new Claim();\n        claim.setPolicy(policy);\n        Assert.assertEquals(claim.getPolicy().getId(), Long.valueOf(2L));\n    }\n\n    @Test(groups = \"jpa\", priority = 14)\n    public void testNoTransitiveDependencyOnUserName_3NF() {\n        User user = new User(\"Name\", \"email @example.com\", \"pwd\", \"USER\");\n        Policy policy = new Policy();\n        policy.setUser(user);\n        Assert.assertEquals(policy.getUser().getName(), \"Name\");\n    }\n\n    @Test(groups = \"jpa\", priority = 14)\n    public void testClaimHasAtomicAttributes() {\n        Claim claim = new Claim();\n        claim.setDescription(\"Accident damage\");\n        Assert.assertEquals(claim.getDescription(), \"Accident damage\");\n    }\n\n    @Test(groups = \"jpa\", priority = 14)\n    public void testFraudCheckResultSnapshotDoesNotBreak3NF() {\n        FraudCheckResult result = new FraudCheckResult();\n        result.setMatchedRules(\"Rule1,Rule2\");\n        Assert.assertTrue(result.getMatchedRules().contains(\"Rule1\"));\n    }\n\n    @Test(groups = \"jpa\", priority = 15)\n    public void testMappingsAllowNormalizedQueryPatterns() {\n        Assert.assertTrue(true);\n    }\n\n    // ============================================================\n    // 6) Many-to-Many relationships and associations in Spring Boot\n    // ============================================================\n\n    @Test(groups = \"manyToMany\", priority = 16)\n    public void testClaimCanHoldMultipleFraudRules() {\n        Claim claim = new Claim();\n        FraudRule r1 = new FraudRule(\"R1\", \"claimAmount\", \">\", \"5000\", \"HIGH\");\n        FraudRule r2 = new FraudRule(\"R2\", \"claimAmount\", \">\", \"10000\", \"HIGH\");\n\n        claim.setSuspectedRules(Set.of(r1, r2));\n        Assert.assertEquals(claim.getSuspectedRules().size(), 2);\n    }\n\n    @Test(groups = \"manyToMany\", priority = 16)\n    public void testFraudRuleKnowsItsClaims() {\n        Claim claim = new Claim();\n        claim.setId(1L);\n\n        FraudRule rule = new FraudRule();\n        rule.setRuleName(\"R1\");\n        rule.setClaims(Set.of(claim));\n\n        Assert.assertEquals(rule.getClaims().iterator().next().getId(), Long.valueOf(1L));\n    }\n\n    @Test(groups = \"manyToMany\", priority = 17)\n    public void testEmptyManyToManySetIsValid() {\n        Claim claim = new Claim();\n        Assert.assertTrue(claim.getSuspectedRules().isEmpty());\n    }\n\n    @Test(groups = \"manyToMany\", priority = 17)\n    public void testAddAndRemoveRuleFromClaim() {\n        Claim claim = new Claim();\n        FraudRule rule = new FraudRule();\n        rule.setRuleName(\"R1\");\n\n        claim.getSuspectedRules().add(rule);\n        Assert.assertEquals(claim.getSuspectedRules().size(), 1);\n\n        claim.getSuspectedRules().remove(rule);\n        Assert.assertTrue(claim.getSuspectedRules().isEmpty());\n    }\n\n    @Test(groups = \"manyToMany\", priority = 17)\n    public void testManyToManyDoesNotDuplicateRules() {\n        Claim claim = new Claim();\n        FraudRule rule = new FraudRule();\n        rule.setRuleName(\"R1\");\n        claim.getSuspectedRules().add(rule);\n        claim.getSuspectedRules().add(rule);\n        Assert.assertEquals(claim.getSuspectedRules().size(), 1);\n    }\n\n    @Test(groups = \"manyToMany\", priority = 18)\n    public void testManyToManyAssociationsSurvivePersistenceSimulation() {\n        Claim claim = new Claim();\n        FraudRule rule = new FraudRule();\n        rule.setRuleName(\"R1\");\n        claim.getSuspectedRules().add(rule);\n\n        Assert.assertTrue(claim.getSuspectedRules().contains(rule));\n    }\n\n    @Test(groups = \"manyToMany\", priority = 18)\n    public void testRuleWithNoClaimsIsAllowed() {\n        FraudRule rule = new FraudRule();\n        Assert.assertTrue(rule.getClaims().isEmpty());\n    }\n\n    @Test(groups = \"manyToMany\", priority = 18)\n    public void testManyToManyMappingSupportsBidirectionalNavigation() {\n        Claim claim = new Claim();\n        FraudRule rule = new FraudRule();\n        rule.setRuleName(\"R1\");\n        rule.setClaims(Set.of(claim));\n        claim.setSuspectedRules(Set.of(rule));\n\n        Assert.assertTrue(rule.getClaims().contains(claim));\n        Assert.assertTrue(claim.getSuspectedRules().contains(rule));\n    }\n\n    // ============================================================\n    // 7) Basic security controls and JWT token-based authentication\n    // ============================================================\n\n    @Test(groups = \"security\", priority = 19)\n    public void testJwtContainsUserIdEmailRole() {\n        User user = new User(\"Sec\", \"sec @example.com\", \"pwd\", \"ADMIN\");\n        user.setId(99L);\n\n        String secret = \"SuperSecretJwtKeyForDemoProject123\";\n        JwtUtil jwtUtil = new JwtUtil(secret, 3600000);\n\n        String token = jwtUtil.generateToken(user);\n        Assert.assertTrue(jwtUtil.validateToken(token));\n        String email = jwtUtil.getEmailFromToken(token);\n        Assert.assertEquals(email, \"sec @example.com\");\n    }\n\n    @Test(groups = \"security\", priority = 19)\n    public void testJwtInvalidTokenFailsValidation() {\n        String secret = \"SuperSecretJwtKeyForDemoProject123\";\n        JwtUtil jwtUtil = new JwtUtil(secret, 3600000);\n        Assert.assertFalse(jwtUtil.validateToken(\"invalid-token\"));\n    }\n\n    @Test(groups = \"security\", priority = 20)\n    public void testPasswordEncodingForSecurity() {\n        String raw = \"password\";\n        String encoded = passwordEncoder.encode(raw);\n        Assert.assertTrue(passwordEncoder.matches(raw, encoded));\n    }\n\n    @Test(groups = \"security\", priority = 20)\n    public void testUserRoleIsPrefixedWithROLE() {\n        User user = new User(\"Sec\", \"role @example.com\", \"pwd\", \"ADMIN\");\n        Assert.assertEquals(user.getRole(), \"ADMIN\");\n    }\n\n    @Test(groups = \"security\", priority = 20)\n    public void testUnauthorizedAccessScenarioSimulation() {\n        boolean hasToken = false;\n        Assert.assertFalse(hasToken);\n    }\n\n    @Test(groups = \"security\", priority = 21)\n    public void testAuthorizedAccessSimulation() {\n        boolean hasToken = true;\n        Assert.assertTrue(hasToken);\n    }\n\n    @Test(groups = \"security\", priority = 21)\n    public void testAdminRoleCanConfigureRules() {\n        User admin = new User(\"Admin\", \"admin @example.com\", \"pwd\", \"ADMIN\");\n        Assert.assertEquals(admin.getRole(), \"ADMIN\");\n    }\n\n    @Test(groups = \"security\", priority = 21)\n    public void testUserRoleCannotSimulateAdminOperations() {\n        User user = new User(\"U\", \"u @example.com\", \"pwd\", \"USER\");\n        Assert.assertNotEquals(user.getRole(), \"ADMIN\");\n    }\n\n    // ============================================================\n    // 8) Use HQL and HCQL for advanced data querying\n    // ============================================================\n\n    @Test(groups = \"hql\", priority = 22)\n    public void testFindHighValueClaimsReturnsList() {\n        when(hqlQueryHelper.findHighValueClaims(10000.0)).thenReturn(List.of());\n        List<Claim> claims = hqlQueryHelper.findHighValueClaims(10000.0);\n        Assert.assertNotNull(claims);\n    }\n\n    @Test(groups = \"hql\", priority = 22)\n    public void testFindHighValueClaimsParameter() {\n        double minAmount = 5000.0;\n        Assert.assertTrue(minAmount > 0);\n    }\n\n    @Test(groups = \"hql\", priority = 23)\n    public void testCriteriaQueryByDescriptionKeyword() {\n        when(hqlQueryHelper.findClaimsByDescriptionKeyword(\"accident\")).thenReturn(List.of());\n        List<Claim> claims = hqlQueryHelper.findClaimsByDescriptionKeyword(\"accident\");\n        Assert.assertNotNull(claims);\n    }\n\n    @Test(groups = \"hql\", priority = 23)\n    public void testCriteriaQueryEmptyKeyword() {\n        when(hqlQueryHelper.findClaimsByDescriptionKeyword(\"\")).thenReturn(List.of());\n        List<Claim> claims = hqlQueryHelper.findClaimsByDescriptionKeyword(\"\");\n        Assert.assertNotNull(claims);\n    }\n\n    @Test(groups = \"hql\", priority = 24)\n    public void testHqlQuerySupportsGreaterThanCondition() {\n        double min = 1000.0;\n        Assert.assertTrue(min >= 0);\n    }\n\n    @Test(groups = \"hql\", priority = 24)\n    public void testHqlQueryDoesNotReturnNullList() {\n        when(hqlQueryHelper.findHighValueClaims(0.0)).thenReturn(List.of());\n        List<Claim> claims = hqlQueryHelper.findHighValueClaims(0.0);\n        Assert.assertNotNull(claims);\n    }\n\n    @Test(groups = \"hql\", priority = 24)\n    public void testAdvancedQueryUsedForFraudAnalyticsSimulation() {\n        boolean usedForAnalytics = true;\n        Assert.assertTrue(usedForAnalytics);\n    }\n\n    @Test(groups = \"hql\", priority = 25)\n    public void testHqlAndCriteriaComplementEachOther() {\n        Assert.assertTrue(true);\n    }\n}\n",
    "src/test/java/com/example/demo/TestResultListener.java": "package com.example.demo;\n \nimport org.testng.ITestListener;\nimport org.testng.ITestResult;\n \npublic class TestResultListener implements ITestListener {\n \n    @Override\n    public void onTestSuccess(ITestResult result) {\n        System.out.println(result.getMethod().getMethodName() + \" - PASS\");\n    }\n \n    @Override\n    public void onTestFailure(ITestResult result) {\n        System.out.println(result.getMethod().getMethodName() + \" - FAIL\");\n    }\n \n    @Override\n    public void onTestSkipped(ITestResult result) {\n        System.out.println(result.getMethod().getMethodName() + \" - SKIP\");\n    }\n}\n"
}

def recreate_project():
    print("Starting project recreation...")
    for file_path, content in FILES.items():
        # Handle path separators for the current OS
        file_path = os.path.normpath(file_path)
        dir_name = os.path.dirname(file_path)
        
        if dir_name:
            os.makedirs(dir_name, exist_ok=True)
        
        try:
            with open(file_path, 'w', encoding='utf-8') as f:
                f.write(content)
            print(f"Created: {file_path}")
        except Exception as e:
            print(f"Error creating {file_path}: {e}")
            
    print("-" * 50)
    print("Project recreated successfully!")

if __name__ == "__main__":
    recreate_project()
